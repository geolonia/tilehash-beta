{"version":3,"file":"index.es.js","sources":["../src/zfxy.ts","../src/xyz.ts","../src/index.ts"],"sourcesContent":["export type ZFXYTile = [number, number, number, number];\n\nexport function getParent(tile: ZFXYTile): ZFXYTile {\n  const [f,x,y,z] = tile;\n  return [f>>1,x>>1,y>>1,z-1];\n}\nexport function getChildren(tile: ZFXYTile): ZFXYTile[] {\n  const [f,x,y,z] = tile;\n  return [\n    [f * 2,     x * 2,     y * 2,     z+1], // +0, +0, +0\n    [f * 2,     x * 2,     y * 2 + 1, z+1], // +0, +0, +1\n    [f * 2,     x * 2 + 1, y * 2,     z+1], // +0, +1, +0\n    [f * 2,     x * 2 + 1, y * 2 + 1, z+1], // +0, +1, +1\n    [f * 2 + 1, x * 2,     y * 2,     z+1], // +1, +0, +0\n    [f * 2 + 1, x * 2,     y * 2 + 1, z+1], // +1, +0, +1\n    [f * 2 + 1, x * 2 + 1, y * 2,     z+1], // +1, +1, +0\n    [f * 2 + 1, x * 2 + 1, y * 2 + 1, z+1], // +1, +1, +1\n  ];\n}\n\nexport function generate(tile: ZFXYTile): string {\n  let [f,x,y,z] = tile;\n  let out = '';\n  while (z>0) {\n    const thisTile: ZFXYTile = [f,x,y,z];\n    const parent = getParent(thisTile);\n    const childrenOfParent = getChildren(parent);\n    const positionInParent = childrenOfParent.findIndex(\n      ([xf, xx, xy, xz]) => xf === f && xx === x && xy === y && xz === z\n    );\n    out = positionInParent.toString(8) + out;\n    f = parent[0];\n    x = parent[1];\n    y = parent[2];\n    z = parent[3];\n  }\n  return out;\n}\n\nexport function parse(th: string): ZFXYTile {\n  let children = getChildren([0,0,0,0]);\n  let lastChild: ZFXYTile;\n  for (const c of th) {\n    lastChild = children[parseInt(c, 8)];\n    children = getChildren(lastChild);\n  }\n  return lastChild;\n}\n\nexport function toURL(input: ZFXYTile | string): string {\n  let tile: ZFXYTile;\n  if (typeof input === 'string') {\n    tile = parse(input);\n  } else {\n    tile = input;\n  }\n  const [f,x,y,z] = tile;\n  return `${z}/${f}/${x}/${y}`;\n}\n","export type XYZTile = [number, number, number];\n\nexport function getParent(tile: XYZTile): XYZTile {\n  const [x,y,z] = tile;\n  return [x>>1,y>>1,z-1];\n}\nexport function getChildren(tile: XYZTile): XYZTile[] {\n  const [x,y,z] = tile;\n  return [\n    [x * 2,     y * 2,     z+1], // +0, +0\n    [x * 2,     y * 2 + 1, z+1], // +0, +1\n    [x * 2 + 1, y * 2,     z+1], // +1, +0\n    [x * 2 + 1, y * 2 + 1, z+1], // +1, +1\n  ];\n}\n\nexport function generate(tile: XYZTile): string {\n  let [x,y,z] = tile;\n  if (z % 2 !== 0) {\n    throw new Error('z must be divisible by 2')\n  }\n  let out = BigInt(0);\n  const maxZ = z;\n  while (z>0) {\n    const thisTile: XYZTile = [x,y,z];\n    const parent = getParent(thisTile);\n    const childrenOfParent = getChildren(parent);\n    const positionInParent = childrenOfParent.findIndex(([xx, xy, xz]) => xx === x && xy === y && xz === z);\n    out += (BigInt(positionInParent) << BigInt(2) * BigInt(maxZ - z));\n    x = parent[0];\n    y = parent[1];\n    z = parent[2];\n  }\n  return out.toString(16);\n}\n\nexport function parse(th: string): XYZTile {\n  const int = BigInt(`0o` + th);\n  let bitLen = BigInt(th.length * 4);\n  let scratchInt = int;\n  let children = getChildren([0,0,0]);\n  let lastChild;\n  for (let i = bitLen - BigInt(2); i >= BigInt(0); i -= BigInt(2)) {\n    const posInChildren = scratchInt >> i;\n    lastChild = children[Number(posInChildren)];\n    children = getChildren(lastChild);\n    scratchInt = scratchInt & ((BigInt(2)**i)-BigInt(1));\n  }\n  return lastChild;\n}\n\nexport function toURL(input: XYZTile | string): string {\n  let tile: XYZTile;\n  if (typeof input === 'string') {\n    tile = parse(input);\n  } else {\n    tile = input;\n  }\n  const [x,y,z] = tile;\n  return `${z}/${x}/${y}`;\n}\n","import * as zfxyFuncs from './zfxy';\nimport * as xyzFuncs from './xyz';\n\nexport const zfxy = zfxyFuncs;\nexport const xyz = xyzFuncs;\n"],"names":["getParent","getChildren","generate","parse","toURL"],"mappings":"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"}